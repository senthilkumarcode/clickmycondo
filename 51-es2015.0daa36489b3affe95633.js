(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{uHHg:function(t,i,e){"use strict";e.r(i);var a=e("ofXK"),n=e("tyNb"),o=e("NutR"),r=e("GUTR"),c=e("ThaB"),s=e("wbvY"),l=e("JK/P"),d=e("F/us"),b=e("wd/R"),u=e("fXoL"),m=e("b6Qw"),g=e("668k"),h=e("BR9Y"),p=e("3Pt+"),f=e("8mtn"),y=e("NhFE"),I=e("bvAq");function k(t,i){1&t&&u.Sb(0,"app-loader")}function v(t,i){if(1&t&&(u.Wb(0,"span"),u.Tc(1),u.Vb()),2&t){const t=u.mc().$implicit;u.Cb(1),u.Uc(t.amount)}}function S(t,i){1&t&&(u.Wb(0,"span"),u.Tc(1,"Free"),u.Vb())}const C=function(){return{exact:!0}};function D(t,i){if(1&t){const t=u.Xb();u.Wb(0,"tr"),u.Wb(1,"td",21),u.Tc(2),u.Wb(3,"span",22),u.Tc(4),u.Vb(),u.Vb(),u.Wb(5,"td",21),u.Tc(6),u.Vb(),u.Wb(7,"td",23),u.Tc(8),u.Vb(),u.Wb(9,"td",23),u.Tc(10),u.Vb(),u.Wb(11,"td",23),u.Rc(12,v,2,1,"span",1),u.Rc(13,S,2,0,"span",1),u.Vb(),u.Wb(14,"td"),u.Wb(15,"a",24),u.Sb(16,"i-feather",25),u.Vb(),u.Wb(17,"a",26),u.ic("click",(function(){u.Kc(t);const e=i.index;return u.mc(2).showConfirmModal(e)})),u.Sb(18,"i-feather",27),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=i.$implicit,e=u.mc(2);u.Cb(2),u.Vc(" ",e.getFacilityBookingName(t.apartmentFacilityId)," "),u.Cb(1),u.uc("ngClass",e.getBookingStatus(t.facilityBookingStatusId)),u.Cb(1),u.Uc(e.getBookingStatus(t.facilityBookingStatusId)),u.Cb(2),u.Uc(t.apartmentFacilityBookingId),u.Cb(2),u.Uc(e.getFacilityBookingSlot(t.slotId)),u.Cb(2),u.Uc(e.getBookedDate(t.bookedForDate)),u.Cb(2),u.uc("ngIf",t.amount>0),u.Cb(1),u.uc("ngIf",0==t.amount),u.Cb(2),u.wc("routerLink","/ams/facility/edit-booking/",t.apartmentFacilityBookingId,""),u.uc("routerLinkActiveOptions",u.Ac(10,C))}}function B(t,i){1&t&&(u.Wb(0,"tr"),u.Wb(1,"td",28),u.Wb(2,"p",29),u.Tc(3,"No Items available"),u.Vb(),u.Vb(),u.Vb())}function V(t,i){if(1&t){const t=u.Xb();u.Wb(0,"div",3),u.Wb(1,"div",4),u.Wb(2,"div",5),u.Wb(3,"h5"),u.Tc(4,"All Bookings "),u.Wb(5,"span",6),u.Tc(6),u.Vb(),u.Vb(),u.Vb(),u.Wb(7,"ul",7),u.Wb(8,"li",8),u.Sb(9,"i",9),u.Wb(10,"input",10),u.ic("ngModelChange",(function(i){return u.Kc(t),u.mc().bookingData=i})),u.Vb(),u.Vb(),u.Wb(11,"li",11),u.Wb(12,"a",12),u.Sb(13,"i-feather",13),u.Wb(14,"span"),u.Tc(15,"Create Booking"),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Vb(),u.Wb(16,"div",14),u.Wb(17,"table",15),u.Wb(18,"thead"),u.Wb(19,"tr"),u.Wb(20,"th",16),u.ic("click",(function(){return u.Kc(t),u.mc().sortUnitData("facilityName")})),u.Tc(21,"Facility Name "),u.Sb(22,"span",17),u.Vb(),u.Wb(23,"th",16),u.ic("click",(function(){return u.Kc(t),u.mc().sortUnitData("facilityId")})),u.Tc(24,"Facility ID "),u.Sb(25,"span",17),u.Vb(),u.Wb(26,"th",16),u.ic("click",(function(){return u.Kc(t),u.mc().sortUnitData("slot")})),u.Tc(27,"Slot"),u.Sb(28,"span",17),u.Vb(),u.Wb(29,"th",16),u.ic("click",(function(){return u.Kc(t),u.mc().sortUnitData("date")})),u.Tc(30,"Booked For "),u.Sb(31,"span",17),u.Vb(),u.Wb(32,"th",16),u.ic("click",(function(){return u.Kc(t),u.mc().sortUnitData("cost")})),u.Tc(33,"Cost "),u.Sb(34,"span",17),u.Vb(),u.Wb(35,"th",18),u.Tc(36,"Action"),u.Vb(),u.Vb(),u.Vb(),u.Wb(37,"tbody"),u.Rc(38,D,19,11,"tr",19),u.nc(39,"simpleSearch"),u.nc(40,"slice"),u.nc(41,"orderBy"),u.Rc(42,B,4,0,"tr",1),u.Vb(),u.Vb(),u.Wb(43,"app-pagination",20),u.ic("outputParams",(function(i){return u.Kc(t),u.mc().getIndexParams(i)})),u.Vb(),u.Vb(),u.Vb()}if(2&t){const t=u.mc();u.Cb(6),u.Uc(t.totalItems),u.Cb(4),u.uc("ngModel",t.bookingData),u.Cb(2),u.uc("routerLinkActiveOptions",u.Ac(26,C)),u.Cb(5),u.uc("ngClass",t.isMobileView()),u.Cb(5),u.uc("ngClass",t.getFieldOrderBy("facilityName")),u.Cb(3),u.uc("ngClass",t.getFieldOrderBy("facilityId")),u.Cb(3),u.uc("ngClass",t.getFieldOrderBy("slot")),u.Cb(3),u.uc("ngClass",t.getFieldOrderBy("Date")),u.Cb(3),u.uc("ngClass",t.getFieldOrderBy("cost")),u.Cb(4),u.uc("ngForOf",u.pc(39,15,u.qc(40,18,u.qc(41,22,t.bookingListData,t.unitFieldType,t.unitOrder),t.ItemUserStartIndex,t.ItemUserEndIndex),t.bookingData)),u.Cb(4),u.uc("ngIf",t.isNoItems),u.Cb(1),u.uc("totalItems",t.totalItems)("ItemStartIndex",t.ItemStartIndex)("ItemEndIndex",t.ItemEndIndex)("itemLimit",t.itemLimit)}}let F=(()=>{class t{constructor(t,i,e,a,n,o,r,c){this.router=t,this.route=i,this.injector=e,this.userService=a,this.facilityService=n,this.lookupService=o,this.sharedService=r,this.cookieService=c,this.isBookingDataLoaded=!1,this.unitFieldType="unitno",this.unitOrder=!1,this.ItemStartIndex=0,this.itemLimit=20,this.bookingData="",this.staffData="",this.isNoItems=!1,this.modalService=this.injector.get(l.a)}getIndexParams(t){this.ItemStartIndex=t.ItemStartIndex,this.ItemEndIndex=t.ItemEndIndex,this.itemLimit=t.itemLimit}sortUnitData(t){this.unitFieldType=t,this.unitOrder=!this.unitOrder}getFieldOrderBy(t){return this.unitFieldType==t?this.unitOrder?"desc":"asc":""}isMobileView(){return window.innerWidth<=767?"table-responsive":""}getFacilityBookingName(t){var i=d.filter(this.facilityCategoryData,(function(i){if(i.apartmentFacilityId===t)return i}));return void 0===i||0==i.length?"":i[0].facilityName}getFacilityBookingSlot(t){var i=d.filter(this.facilitySlotData,(function(i){if(i.apartmentFacilitySlotId===t)return i}));if(void 0===i||0==i.length)return"";var e=b(i[0].slotBeginTime,"HH:mm:ss").toDate(),a=b(e).format("HH:mm A"),n=b(i[0].slotEndTime,"HH:mm:ss").toDate();return a+" - "+b(n).format("HH:mm A")}getBookedDate(t){return b(t).format("DD/MM/YYYY")}getUserName(t){var i=d.filter(this.userListData,(function(i){if(i.userId===t)return i}));return void 0===i||0==i.length?"":i[0].firstName}getBookingStatus(t){var i=d.filter(this.statusTypeData,(function(i){if(i.lookupValueId===t)return i}));return void 0===i||0==i.length?"":i[0].lookupValueName.toLowerCase()}showConfirmModal(t){this.modalService.showConfirmModal(t)}ngOnInit(){this.facilityService.getApartmentFacilitiesByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilityCategoryData=t.filter(t=>t.isActive),console.log(this.facilityCategoryData)},t=>{}),this.lookupService.getLookupValueByLookupTypeId(40).subscribe(t=>{this.statusTypeData=t.filter(t=>t.isActive)},t=>{}),this.facilityService.getApartmentFacilitySlotsByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilitySlotData=t.filter(t=>t.isActive)},t=>{}),this.userService.getAllUsersByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.userListData=t.filter(t=>t.isActive)},t=>{}),this.facilityService.getApartmentFacilityBookingsByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.bookingListData=t.filter(t=>t.isActive&&t.neededUserId==parseInt(this.cookieService.get("userId"))),0!=this.bookingListData.length&&null!=this.bookingListData||(this.isNoItems=!0),this.totalItems=this.bookingListData.length,this.ItemEndIndex=this.totalItems>this.itemLimit?this.itemLimit:this.totalItems,this.isBookingDataLoaded=!0},t=>{}),this.sharedService.unitlistdeleteindexcast.subscribe(t=>{if(null!=t){var i={apartmentFacilityBookingId:this.bookingListData[t].apartmentFacilityBookingId,deleteBy:parseInt(this.cookieService.get("userId"))};this.isBookingDataLoaded=!1,this.facilityService.deleteApartmentFacilityBooking(i).subscribe(i=>{this.bookingListData.splice(t,1),this.totalItems=this.bookingListData.length,this.isBookingDataLoaded=!0,this.sharedService.setUnitListDeleteIndex(null)},t=>{console.log(t)})}})}}return t.\u0275fac=function(i){return new(i||t)(u.Rb(n.c),u.Rb(n.a),u.Rb(u.r),u.Rb(o.a),u.Rb(r.a),u.Rb(c.a),u.Rb(s.a),u.Rb(m.a))},t.\u0275cmp=u.Lb({type:t,selectors:[["app-all-facility-bookings"]],decls:3,vars:2,consts:[[1,"all-facility-bookings-wrapper"],[4,"ngIf"],["class","card table-card",4,"ngIf"],[1,"card","table-card"],[1,"card-header"],[1,"float-left"],[1,"badge","lime-green"],[1,"list-inline"],[1,"list-inline-item","search","d-none","d-md-inline-block"],["aria-hidden","true",1,"fa","fa-search"],["type","text","placeholder","Search...",1,"form-control",3,"ngModel","ngModelChange"],[1,"list-inline-item"],["routerLink","/user/facility-booking/create-booking","routerLinkActive","active",1,"btn","lime-green","mt_5",3,"routerLinkActiveOptions"],["name","plus",1,"icon","plus"],[1,"card-body","p-0"],[1,"table",3,"ngClass"],["scope","col",3,"click"],[3,"ngClass"],["scope","col"],[4,"ngFor","ngForOf"],[3,"totalItems","ItemStartIndex","ItemEndIndex","itemLimit","outputParams"],[1,"name"],[1,"badge","small","min","text-capitalize",3,"ngClass"],[1,"grey"],["href","javascript:void(0)","placement","top","routerLinkActive","active",1,"mr-2",3,"routerLink","routerLinkActiveOptions"],["name","edit",1,"icon","edit"],["href","javascript:void(0)",3,"click"],["name","trash",1,"icon","delete"],["colspan","6",1,"grey","text-center"],[1,"message"]],template:function(t,i){1&t&&(u.Wb(0,"div",0),u.Rc(1,k,1,0,"app-loader",1),u.Rc(2,V,44,27,"div",2),u.Vb()),2&t&&(u.Cb(1),u.uc("ngIf",!i.isBookingDataLoaded),u.Cb(1),u.uc("ngIf",i.isBookingDataLoaded))},directives:[a.l,g.a,h.b,p.d,p.n,p.q,n.e,n.d,f.b,a.j,a.k,y.a],pipes:[I.c,a.t,I.b],styles:[""]}),t})();var L=e("iOEq"),W=e("IvIE");function A(t,i){1&t&&u.Sb(0,"app-loader")}const T=function(){return{left:"today, prev,next",center:"title",right:"dayGridDay,dayGridWeek,dayGridMonth"}};function w(t,i){if(1&t){const t=u.Xb();u.Ub(0),u.Wb(1,"full-calendar",2),u.ic("eventClick",(function(i){return u.Kc(t),u.mc().handleEventClick(i)})),u.Vb(),u.Tb()}if(2&t){const t=u.mc();u.Cb(1),u.uc("plugins",t.calendarPlugins)("header",u.Ac(3,T))("events",t.calendarEvents)}}let R=(()=>{class t{constructor(t,i,e,a,n,o){this.router=t,this.route=i,this.facilityService=e,this.lookupService=a,this.sharedService=n,this.cookieService=o,this.calendarPlugins=[L.a],this.calendarEvents=[],this.isCalenderLoaded=!1}handleEventClick(t){this.router.navigate(["/user/facility-booking/edit-booking",t.event.id])}getFacilityBookingData(){this.facilityService.getApartmentFacilitySlotsByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilitySlotData=t.filter(t=>t.isActive)},t=>{}),this.facilityService.getApartmentFacilitiesByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilityCategoryData=t.filter(t=>t.isActive),this.facilityService.getApartmentFacilityBookingsByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilityBookingData=t.filter(t=>t.isActive&&t.neededUserId==parseInt(this.cookieService.get("userId"))),d.each(this.facilityBookingData,t=>{var i=b(t.bookedForDate).format("YYYY-MM-DD"),e=this.facilityCategoryData.filter(i=>i.apartmentFacilityId==t.apartmentFacilityId),a=this.facilitySlotData.filter(i=>i.apartmentFacilitySlotId==t.slotId),n=b(a[0].slotBeginTime,"HH:mm:ss").toDate(),o=b(n).format("HH:mm A"),r=b(a[0].slotEndTime,"HH:mm:ss").toDate(),c=b(r).format("HH:mm A");this.calendarEvents.push({title:e[0].facilityName+" ( "+o+"-"+c+" ) ",date:i,id:e[0].apartmentFacilityId}),this.isCalenderLoaded=!0})},t=>{})},t=>{})}ngOnInit(){this.getFacilityBookingData()}}return t.\u0275fac=function(i){return new(i||t)(u.Rb(n.c),u.Rb(n.a),u.Rb(r.a),u.Rb(c.a),u.Rb(s.a),u.Rb(m.a))},t.\u0275cmp=u.Lb({type:t,selectors:[["app-user-facility-calendar"]],decls:3,vars:2,consts:[[1,"full-calendar-wrapper"],[4,"ngIf"],["defaultView","dayGridMonth",3,"plugins","header","events","eventClick"]],template:function(t,i){1&t&&(u.Wb(0,"div",0),u.Rc(1,A,1,0,"app-loader",1),u.Rc(2,w,2,4,"ng-container",1),u.Vb()),2&t&&(u.Cb(1),u.uc("ngIf",!i.isCalenderLoaded),u.Cb(1),u.uc("ngIf",i.isCalenderLoaded))},directives:[a.l,g.a,W.a],styles:[""]}),t})();var x=e("Nw7d");const O=[{path:"",redirectTo:"all-bookings",pathMatch:"full"},{path:"all-bookings",component:F},{path:"create-booking",component:x.a},{path:"edit-booking/:id",component:x.a},{path:"calendar",component:R},{path:"**",redirectTo:"all-bookings",pathMatch:"full"}];let U=(()=>{class t{}return t.\u0275mod=u.Pb({type:t}),t.\u0275inj=u.Ob({factory:function(i){return new(i||t)},imports:[[n.f.forChild(O)],n.f]}),t})();var N=e("PCNd");let H=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=u.Lb({type:t,selectors:[["app-facility-booking"]],decls:1,vars:0,template:function(t,i){1&t&&u.Sb(0,"router-outlet")},directives:[n.g],styles:[""]}),t})();e.d(i,"FacilityBookingModule",(function(){return M}));let M=(()=>{class t{}return t.\u0275mod=u.Pb({type:t,bootstrap:[H]}),t.\u0275inj=u.Ob({factory:function(i){return new(i||t)},imports:[[a.b,N.a,U]]}),t})()}}]);