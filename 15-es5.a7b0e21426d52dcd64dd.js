function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var c=e[i];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,c.key,c)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"G65/":function(t,e,i){"use strict";i.d(e,"a",(function(){return G}));var c=i("NutR"),n=i("Buwz"),a=i("dc4U"),o=i("ThaB"),s=i("wbvY"),r=i("JK/P"),d=i("F/us"),l=i("fXoL"),u=i("b6Qw"),h=i("ofXK"),f=i("668k"),k=i("BR9Y"),m=i("3Pt+"),g=i("8mtn"),p=i("tyNb"),v=i("NhFE"),y=i("bvAq");function b(t,e){1&t&&l.ec(0,"app-loader")}function I(t,e){1&t&&(l.ic(0,"ul",4),l.ic(1,"li",5),l.ec(2,"span",6),l.ic(3,"span"),l.fd(4,"High"),l.hc(),l.hc(),l.ic(5,"li",5),l.ec(6,"span",7),l.fd(7,"Medium"),l.hc(),l.ic(8,"li",8),l.ec(9,"span",9),l.fd(10,"Low"),l.hc(),l.hc())}function C(t,e){if(1&t){var i=l.jc();l.ic(0,"th",24),l.fd(1,"Category "),l.ic(2,"span",25),l.uc("click",(function(){return l.Wc(i),l.yc(2).sortUnitData("category")})),l.hc(),l.hc()}if(2&t){var c=l.yc(2);l.Ob(2),l.Gc("ngClass",c.getFieldOrderBy("category"))}}function O(t,e){if(1&t){var i=l.jc();l.ic(0,"th",24),l.fd(1,"Assigned to "),l.ic(2,"span",25),l.uc("click",(function(){return l.Wc(i),l.yc(2).sortUnitData("assignto")})),l.hc(),l.hc()}if(2&t){var c=l.yc(2);l.Ob(2),l.Gc("ngClass",c.getFieldOrderBy("assignto"))}}function T(t,e){if(1&t){var i=l.jc();l.ic(0,"th",24),l.fd(1,"Requested By "),l.ic(2,"span",25),l.uc("click",(function(){return l.Wc(i),l.yc(2).sortUnitData("requested")})),l.hc(),l.hc()}if(2&t){var c=l.yc(2);l.Ob(2),l.Gc("ngClass",c.getFieldOrderBy("requested"))}}function S(t,e){if(1&t&&(l.ic(0,"td",31),l.fd(1),l.hc()),2&t){var i=l.yc().$implicit,c=l.yc(2);l.Ob(1),l.gd(c.getTicketCategory(i.ticketCategoryId))}}function M(t,e){if(1&t&&(l.ic(0,"td",31),l.fd(1),l.hc()),2&t){var i=l.yc().$implicit,c=l.yc(2);l.Ob(1),l.gd(c.getTicketAssigned(i.assignedTo))}}function D(t,e){if(1&t&&(l.ic(0,"td",31),l.fd(1),l.hc()),2&t){var i=l.yc().$implicit,c=l.yc(2);l.Ob(1),l.gd(c.getTicketRequested(i.raisedBy))}}var A=function(){return{exact:!0}};function L(t,e){if(1&t){var i=l.jc();l.ic(0,"tr"),l.ic(1,"td"),l.fd(2),l.hc(),l.ic(3,"td"),l.ic(4,"span",30),l.fd(5),l.hc(),l.hc(),l.ic(6,"td",31),l.fd(7),l.hc(),l.dd(8,S,2,1,"td",32),l.ic(9,"td"),l.fd(10),l.hc(),l.dd(11,M,2,1,"td",32),l.dd(12,D,2,1,"td",32),l.ic(13,"td"),l.ic(14,"a",33),l.ec(15,"i-feather",34),l.hc(),l.ic(16,"a",35),l.uc("click",(function(){l.Wc(i);var t=e.index;return l.yc(2).showConfirmModal(t)})),l.ec(17,"i-feather",36),l.hc(),l.ic(18,"a",37),l.ec(19,"span",38),l.hc(),l.hc(),l.hc()}if(2&t){var c=e.$implicit,n=l.yc(2);l.Ob(2),l.gd(c.ticketId),l.Ob(2),l.Gc("ngClass",n.getTicketStatus(c.ticketStatusId)),l.Ob(1),l.gd(n.getTicketStatus(c.ticketStatusId)),l.Ob(2),l.gd(n.getTicketType(c.ticketTypeId)),l.Ob(1),l.Gc("ngIf",!n.isAdmin()),l.Ob(2),l.gd(c.title),l.Ob(1),l.Gc("ngIf",n.isAdmin()),l.Ob(1),l.Gc("ngIf",n.isAdmin()),l.Ob(2),l.Ic("routerLink","/ams/helpdesk/edit-ticket/",c.ticketId,""),l.Gc("routerLinkActiveOptions",l.Mc(11,A)),l.Ob(5),l.Gc("ngClass",n.getTicketPriority(c.ticketPriorityId))}}function P(t,e){1&t&&(l.ic(0,"div",39),l.ic(1,"p",40),l.fd(2,"No Data Available"),l.hc(),l.hc())}function B(t,e){if(1&t){var i=l.jc();l.ic(0,"div",10),l.ic(1,"div",11),l.ic(2,"div",12),l.ic(3,"h5"),l.fd(4,"All Tickets "),l.ic(5,"span",13),l.fd(6),l.hc(),l.hc(),l.hc(),l.ic(7,"ul",14),l.ic(8,"li",15),l.ec(9,"i",16),l.ic(10,"input",17),l.uc("ngModelChange",(function(t){return l.Wc(i),l.yc().ticketData=t})),l.hc(),l.hc(),l.ic(11,"li",5),l.ic(12,"a",18),l.ec(13,"i-feather",19),l.ic(14,"span"),l.fd(15,"Print"),l.hc(),l.hc(),l.hc(),l.ic(16,"li",5),l.ic(17,"a",20),l.ec(18,"i-feather",21),l.ic(19,"span"),l.fd(20,"Add Ticket"),l.hc(),l.hc(),l.hc(),l.hc(),l.hc(),l.ic(21,"div",22),l.ic(22,"table",23),l.ic(23,"thead"),l.ic(24,"tr"),l.ic(25,"th",24),l.fd(26,"Ticket ID "),l.ic(27,"span",25),l.uc("click",(function(){return l.Wc(i),l.yc().sortUnitData("ticketId")})),l.hc(),l.hc(),l.ic(28,"th",24),l.fd(29,"Status "),l.ic(30,"span",25),l.uc("click",(function(){return l.Wc(i),l.yc().sortUnitData("status")})),l.hc(),l.hc(),l.ic(31,"th",24),l.fd(32,"Type "),l.ic(33,"span",25),l.uc("click",(function(){return l.Wc(i),l.yc().sortUnitData("type")})),l.hc(),l.hc(),l.dd(34,C,3,1,"th",26),l.ic(35,"th",24),l.fd(36,"Subject "),l.ic(37,"span",25),l.uc("click",(function(){return l.Wc(i),l.yc().sortUnitData("subject")})),l.hc(),l.hc(),l.dd(38,O,3,1,"th",26),l.dd(39,T,3,1,"th",26),l.ic(40,"th",24),l.fd(41,"Actions"),l.hc(),l.hc(),l.hc(),l.ic(42,"tbody"),l.dd(43,L,20,12,"tr",27),l.zc(44,"simpleSearch"),l.zc(45,"slice"),l.zc(46,"orderBy"),l.hc(),l.hc(),l.dd(47,P,3,0,"div",28),l.ic(48,"app-pagination",29),l.uc("outputParams",(function(t){return l.Wc(i),l.yc().getIndexParams(t)})),l.hc(),l.hc(),l.hc()}if(2&t){var c=l.yc();l.Ob(6),l.gd(c.totalItems),l.Ob(4),l.Gc("ngModel",c.ticketData),l.Ob(7),l.Gc("routerLinkActiveOptions",l.Mc(28,A)),l.Ob(5),l.Gc("ngClass",c.isMobileView()),l.Ob(5),l.Gc("ngClass",c.getFieldOrderBy("ticketId")),l.Ob(3),l.Gc("ngClass",c.getFieldOrderBy("status")),l.Ob(3),l.Gc("ngClass",c.getFieldOrderBy("type")),l.Ob(1),l.Gc("ngIf",!c.isAdmin()),l.Ob(3),l.Gc("ngClass",c.getFieldOrderBy("subject")),l.Ob(1),l.Gc("ngIf",c.isAdmin()),l.Ob(1),l.Gc("ngIf",c.isAdmin()),l.Ob(4),l.Gc("ngForOf",l.Bc(44,17,l.Cc(45,20,l.Cc(46,24,c.ticketListData,c.unitFieldType,c.unitOrder),c.ItemStartIndex,c.ItemEndIndex),c.ticketData)),l.Ob(4),l.Gc("ngIf",c.isNoItemsAvailable()),l.Ob(1),l.Gc("totalItems",c.totalItems)("ItemStartIndex",c.ItemStartIndex)("ItemEndIndex",c.ItemEndIndex)("itemLimit",c.itemLimit)}}var G=function(){var t=function(){function t(e,i,c,n,a,o,s){_classCallCheck(this,t),this.injector=e,this.userService=i,this.staffService=c,this.ticketService=n,this.lookupService=a,this.sharedService=o,this.cookieService=s,this.ticketData="",this.isTicketDataLoaded=!1,this.slotFieldType="unitno",this.slotData=!1,this.ItemStartIndex=0,this.itemLimit=10,this.ticketStatusData={},this.ticketTypeData={},this.ticketPrivateCategoryData={},this.ticketCommonCategoryData={},this.ticketAssignedToData={},this.ticketPriorityData={},this.ticketType="",this.modalService=this.injector.get(r.a)}return _createClass(t,[{key:"getTicketStatus",value:function(t){var e=d.filter(this.ticketStatusData,(function(e){if(e.lookupValueId===t)return e}));return void 0===e||0==e.length?"":e[0].lookupValueName.toLowerCase()}},{key:"getTicketCategory",value:function(t){var e;return"16"==this.ticketType?void 0===(e=d.filter(this.ticketPrivateCategoryData,(function(e){if(e.lookupValueId===t)return e})))||0==e.length?"":e[0].lookupValueName:void 0===(e=d.filter(this.ticketCommonCategoryData,(function(e){if(e.lookupValueId===t)return e})))||0==e.length?"":e[0].lookupValueName}},{key:"getTicketType",value:function(t){var e=d.filter(this.ticketTypeData,(function(e){if(e.lookupValueId===t)return e}));return void 0===e||0==e.length?"":(this.ticketType=e[0].lookupValueName,e[0].lookupValueName)}},{key:"getTicketAssigned",value:function(t){var e=d.filter(this.assignedToData,(function(e){if(e.staffId===t)return e}));return void 0===e||0==e.length?"":e[0].firstName}},{key:"getTicketRequested",value:function(t){var e=d.filter(this.raisedByData,(function(e){if(e.userId===t)return e}));return void 0===e||0==e.length?"":e[0].firstName}},{key:"getTicketPriority",value:function(t){var e=d.filter(this.ticketPriorityData,(function(e){if(e.lookupValueId===t)return e}));return void 0===e||0==e.length?"":e[0].lookupValueName.toLowerCase()}},{key:"getIndexParams",value:function(t){this.ItemStartIndex=t.ItemStartIndex,this.ItemEndIndex=t.ItemEndIndex}},{key:"sortUnitData",value:function(t){this.slotFieldType=t,this.slotData=!this.slotData}},{key:"getFieldOrderBy",value:function(t){return this.slotFieldType==t?this.slotData?"desc":"asc":""}},{key:"isMobileView",value:function(){return window.innerWidth<=767?"table-responsive":""}},{key:"showConfirmModal",value:function(t){this.modalService.showConfirmModal(t)}},{key:"isItemsAvailable",value:function(){return this.totalItems>0}},{key:"isNoItemsAvailable",value:function(){return 0==this.totalItems}},{key:"isAdmin",value:function(){return"Admin"==this.cookieService.get("userRole")||"Staff"==this.cookieService.get("userRole")}},{key:"ngOnInit",value:function(){var t=this;"Admin"!=this.cookieService.get("userRole")&&"Staff"!=this.cookieService.get("userRole")||this.ticketService.getAllTicketsByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe((function(e){t.ticketListData=e.filter((function(t){return t.isActive})),t.totalItems=t.ticketListData.length,t.ItemEndIndex=t.totalItems>t.itemLimit?t.itemLimit:t.totalItems,t.isTicketDataLoaded=!0}),(function(t){})),"Tenant"!=this.cookieService.get("userRole")&&"Owner"!=this.cookieService.get("userRole")||this.ticketService.getTicketsByRaisedUserId(parseInt(this.cookieService.get("userId"))).subscribe((function(e){t.ticketListData=e.filter((function(t){return t.isActive})),t.totalItems=t.ticketListData.length,t.ItemEndIndex=t.totalItems>t.itemLimit?t.itemLimit:t.totalItems,t.isTicketDataLoaded=!0}),(function(t){})),this.lookupService.getLookupValueByLookupTypeId(7).subscribe((function(e){t.ticketTypeData=e}),(function(t){})),this.lookupService.getLookupValueByLookupTypeId(16).subscribe((function(e){t.ticketPrivateCategoryData=e}),(function(t){})),this.lookupService.getLookupValueByLookupTypeId(17).subscribe((function(e){t.ticketCommonCategoryData=e}),(function(t){})),this.lookupService.getLookupValueByLookupTypeId(9).subscribe((function(e){t.ticketStatusData=e,t.totalFilterItems[0].data=t.ticketStatusData}),(function(t){})),this.lookupService.getLookupValueByLookupTypeId(14).subscribe((function(e){t.ticketPriorityData=e,t.totalFilterItems[1].data=t.ticketPriorityData}),(function(t){})),this.staffService.getAllStaffs().subscribe((function(e){t.assignedToData=e,console.log(e)}),(function(t){})),this.userService.getAllUsersByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe((function(e){t.raisedByData=e}),(function(t){})),this.sharedService.unitlistdeleteindexcast.subscribe((function(e){if(null!=e){var i={ticketId:t.ticketListData[e].ticketId,deleteBy:parseInt(t.cookieService.get("userId"))};t.isTicketDataLoaded=!1,t.ticketService.deleteTicket(i).subscribe((function(i){t.ticketListData.splice(e,1),t.totalItems=t.ticketListData.length,t.isTicketDataLoaded=!0,t.sharedService.setUnitListDeleteIndex(null)}),(function(t){console.log(t)}))}})),this.totalFilterItems=[{label:"Status"},{label:"Priority"}]}}]),t}();return t.\u0275fac=function(e){return new(e||t)(l.dc(l.x),l.dc(c.a),l.dc(n.a),l.dc(a.a),l.dc(o.a),l.dc(s.a),l.dc(u.a))},t.\u0275cmp=l.Xb({type:t,selectors:[["app-helpdesk-all-tickets"]],decls:4,vars:3,consts:[[1,"helpdesk-all-tickets-wrapper"],[4,"ngIf"],["class","legends list-inline",4,"ngIf"],["class","card clear card-table",4,"ngIf"],[1,"legends","list-inline"],[1,"list-inline-item"],[1,"dots","high"],[1,"dots","medium"],[1,"list-inline-item","mr-0"],[1,"dots","low"],[1,"card","clear","card-table"],[1,"card-header"],[1,"float-left"],[1,"badge","lime-green"],[1,"list-inline"],[1,"list-inline-item","search","d-none","d-md-inline-block"],["aria-hidden","true",1,"fa","fa-search"],["type","text","placeholder","Search...",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","trans-white","mt_5"],["name","printer",1,"icon","print"],["routerLink","/ams/helpdesk/add-ticket","routerLinkActive","active",1,"btn","lime-green","mt_5",3,"routerLinkActiveOptions"],["name","plus",1,"icon","plus"],[1,"card-body","p-0"],[1,"table","table-resizable",3,"ngClass"],["scope","col"],[3,"ngClass","click"],["scope","col",4,"ngIf"],[4,"ngFor","ngForOf"],["class","button-wrapper border-top",4,"ngIf"],[3,"totalItems","ItemStartIndex","ItemEndIndex","itemLimit","outputParams"],[1,"badge","small","min","text-capitalize",3,"ngClass"],[1,"grey"],["class","grey",4,"ngIf"],["href","javascript:void(0)","routerLinkActive","active",1,"mr-2",3,"routerLink","routerLinkActiveOptions"],["name","edit",1,"icon","edit"],["href","javascript:void(0)",1,"mr-2",3,"click"],["name","trash",1,"icon","delete"],["href","javascript:void(0)",1,"no-link"],[1,"dots","rt-3",3,"ngClass"],[1,"button-wrapper","border-top"],[1,"snippet"]],template:function(t,e){1&t&&(l.ic(0,"div",0),l.dd(1,b,1,0,"app-loader",1),l.dd(2,I,11,0,"ul",2),l.dd(3,B,49,29,"div",3),l.hc()),2&t&&(l.Ob(1),l.Gc("ngIf",!e.isTicketDataLoaded),l.Ob(1),l.Gc("ngIf",e.isTicketDataLoaded),l.Ob(1),l.Gc("ngIf",e.isTicketDataLoaded))},directives:[h.l,f.a,k.c,k.a,m.d,m.n,m.q,g.b,p.e,p.d,k.f,h.j,h.k,v.a],pipes:[y.c,h.t,y.b],styles:[""]}),t}()},KrOI:function(t,e,i){"use strict";i.d(e,"a",(function(){return j}));var c=i("fXoL"),n=i("NutR"),a=i("dc4U"),o=i("Buwz"),s=i("ThaB"),r=i("wbvY"),d=i("F/us"),l=i("wd/R"),u=i("tyNb"),h=i("b6Qw"),f=i("ofXK"),k=i("8mtn"),m=i("3Pt+"),g=i("wlDI"),p=i("668k"),v=i("BR9Y");function y(t,e){1&t&&(c.ic(0,"span"),c.fd(1,"Add Ticket"),c.hc())}function b(t,e){1&t&&(c.ic(0,"span"),c.fd(1,"Edit Ticket"),c.hc())}function I(t,e){1&t&&c.ec(0,"app-loader")}function C(t,e){if(1&t&&(c.ic(0,"option",41),c.fd(1),c.hc()),2&t){var i=e.$implicit;c.Gc("value",i.lookupValueId),c.Ob(1),c.gd(i.lookupValueName)}}function O(t,e){if(1&t){var i=c.jc();c.ic(0,"div",20),c.ic(1,"div",21),c.ic(2,"label"),c.fd(3,"Status*"),c.hc(),c.ic(4,"select",40),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc(2).ticket.ticketStatusId=t})),c.ic(5,"option",23),c.fd(6,"Select"),c.hc(),c.dd(7,C,2,2,"option",24),c.hc(),c.hc(),c.hc()}if(2&t){var n=c.yc(2);c.Ob(4),c.Gc("ngModel",n.ticket.ticketStatusId),c.Ob(3),c.Gc("ngForOf",n.statusTypeData)}}function T(t,e){if(1&t&&(c.ic(0,"option",41),c.fd(1),c.hc()),2&t){var i=e.$implicit;c.Gc("value",i.lookupValueId),c.Ob(1),c.gd(i.lookupValueName)}}function S(t,e){if(1&t&&(c.ic(0,"option",41),c.fd(1),c.hc()),2&t){var i=e.$implicit;c.Gc("value",i.lookupValueId),c.Ob(1),c.gd(i.lookupValueName)}}function M(t,e){if(1&t){var i=c.jc();c.ic(0,"div",20),c.ic(1,"div",21),c.ic(2,"label"),c.fd(3,"Category*"),c.hc(),c.ic(4,"select",42),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc(2).ticket.ticketCategoryId=t})),c.ic(5,"option",23),c.fd(6,"Select"),c.hc(),c.dd(7,S,2,2,"option",24),c.hc(),c.hc(),c.hc()}if(2&t){var n=c.yc(2);c.Ob(4),c.Gc("ngModel",n.ticket.ticketCategoryId),c.Ob(3),c.Gc("ngForOf",n.ticketCategoryData)}}function D(t,e){if(1&t&&(c.ic(0,"option",41),c.fd(1),c.hc()),2&t){var i=e.$implicit;c.Gc("value",i.lookupValueId),c.Ob(1),c.gd(i.lookupValueName)}}function A(t,e){if(1&t&&(c.ic(0,"option",41),c.fd(1),c.hc()),2&t){var i=e.$implicit;c.Gc("value",i.userId),c.Ob(1),c.gd(i.firstName)}}function L(t,e){if(1&t&&(c.ic(0,"option",41),c.fd(1),c.hc()),2&t){var i=e.$implicit;c.Gc("value",i.staffId),c.Ob(1),c.gd(i.firstName)}}function P(t,e){if(1&t){var i=c.jc();c.ic(0,"div",20),c.ic(1,"div",27),c.ic(2,"label"),c.fd(3,"Assigned To*"),c.hc(),c.ic(4,"select",43),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc(2).ticket.assignedTo=t})),c.ic(5,"option",23),c.fd(6,"Select"),c.hc(),c.dd(7,L,2,2,"option",24),c.hc(),c.hc(),c.hc()}if(2&t){var n=c.yc(2);c.Ob(4),c.Gc("ngModel",n.ticket.assignedTo),c.Ob(3),c.Gc("ngForOf",n.assignedToData)}}function B(t,e){if(1&t){var i=c.jc();c.ic(0,"div"),c.ic(1,"span",45),c.fd(2),c.hc(),c.ic(3,"span",46),c.fd(4),c.hc(),c.ic(5,"i-feather",47),c.uc("click",(function(){c.Wc(i);var t=e.index;return c.yc(3).deleteFile(t)})),c.hc(),c.hc()}if(2&t){var n=e.$implicit,a=c.yc(3);c.Ob(2),c.gd(n.name),c.Ob(2),c.gd(a.bytesToSize(n.size))}}function G(t,e){if(1&t&&(c.ic(0,"div",44),c.dd(1,B,6,2,"div",15),c.hc()),2&t){var i=c.yc(2);c.Ob(1),c.Gc("ngForOf",i.listOfFiles)}}function F(t,e){if(1&t){var i=c.jc();c.gc(0),c.ic(1,"div",18),c.dd(2,O,8,2,"div",19),c.ic(3,"div",20),c.ic(4,"div",21),c.ic(5,"label"),c.fd(6,"Type*"),c.hc(),c.ic(7,"select",22),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc().ticket.ticketTypeId=t}))("ngModelChange",(function(){c.Wc(i);var t=c.yc();return t.getTicketType(t.ticket.ticketTypeId)})),c.ic(8,"option",23),c.fd(9,"Select"),c.hc(),c.dd(10,T,2,2,"option",24),c.hc(),c.hc(),c.hc(),c.dd(11,M,8,2,"div",19),c.ic(12,"div",20),c.ic(13,"div",25),c.ic(14,"label"),c.fd(15,"Subject*"),c.hc(),c.ic(16,"input",26),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc().ticket.title=t})),c.hc(),c.hc(),c.hc(),c.ic(17,"div",20),c.ic(18,"div",27),c.ic(19,"label"),c.fd(20,"Priorty*"),c.hc(),c.ic(21,"select",28),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc().ticket.ticketPriorityId=t})),c.ic(22,"option",23),c.fd(23,"Select"),c.hc(),c.dd(24,D,2,2,"option",24),c.hc(),c.hc(),c.hc(),c.ic(25,"div",20),c.ic(26,"div",27),c.ic(27,"label"),c.fd(28,"Requested By*"),c.hc(),c.ic(29,"select",29),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc().ticket.raisedBy=t})),c.ic(30,"option",23),c.fd(31,"Select"),c.hc(),c.dd(32,A,2,2,"option",24),c.hc(),c.hc(),c.hc(),c.dd(33,P,8,2,"div",19),c.ic(34,"div",30),c.ic(35,"div",25),c.ic(36,"label"),c.fd(37,"Description*"),c.hc(),c.ic(38,"textarea",31),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc().ticket.description=t})),c.hc(),c.hc(),c.hc(),c.ic(39,"div",30),c.ic(40,"div",25),c.ic(41,"label",32),c.uc("click",(function(){return c.Wc(i),c.Tc(43).click()})),c.ic(42,"input",33,34),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc().ticket.file=t}))("change",(function(t){return c.Wc(i),c.yc().uploadFile(t)})),c.hc(),c.ec(44,"i",35),c.fd(45," Add Document"),c.hc(),c.dd(46,G,2,1,"div",36),c.hc(),c.hc(),c.ic(47,"div",30),c.ic(48,"ul",37),c.ic(49,"li",38),c.ic(50,"button",39),c.fd(51,"Submit"),c.hc(),c.hc(),c.hc(),c.hc(),c.hc(),c.fc()}if(2&t){var n=c.yc(),a=c.Tc(14);c.Ob(2),c.Gc("ngIf",n.isEditTicket&&n.isAdmin()),c.Ob(5),c.Gc("ngModel",n.ticket.ticketTypeId),c.Ob(3),c.Gc("ngForOf",n.ticketTypeData),c.Ob(1),c.Gc("ngIf",n.isCategoryEnabled()),c.Ob(5),c.Gc("ngModel",n.ticket.title),c.Ob(5),c.Gc("ngModel",n.ticket.ticketPriorityId),c.Ob(3),c.Gc("ngForOf",n.priortyTypeData),c.Ob(5),c.Gc("ngModel",n.ticket.raisedBy),c.Ob(3),c.Gc("ngForOf",n.raisedByData),c.Ob(1),c.Gc("ngIf",n.isAdmin()&&n.isEditTicket),c.Ob(5),c.Gc("ngModel",n.ticket.description),c.Ob(4),c.Gc("ngModel",n.ticket.file),c.Ob(4),c.Gc("ngIf",n.isFileAdded),c.Ob(4),c.Gc("disabled",a.invalid)}}function w(t,e){if(1&t){var i=c.jc();c.ic(0,"div",48),c.ic(1,"div",12),c.ic(2,"form",49,50),c.uc("ngSubmit",(function(){c.Wc(i);var t=c.Tc(3);return c.yc().submitCommentForm(t)})),c.ec(4,"app-alert-message",51),c.ic(5,"div",18),c.ic(6,"div",30),c.ic(7,"div",25),c.ic(8,"label"),c.fd(9,"Add Comment"),c.hc(),c.ic(10,"textarea",52),c.uc("ngModelChange",(function(t){return c.Wc(i),c.yc().ticketComment=t})),c.hc(),c.hc(),c.ic(11,"button",53),c.fd(12,"Submit"),c.hc(),c.hc(),c.hc(),c.hc(),c.hc(),c.hc()}if(2&t){var n=c.Tc(3),a=c.yc();c.Ob(4),c.Gc("message",a.alertCommentMessage)("isError",a.isCommentError)("isSuccess",a.isCommentSuccess),c.Ob(6),c.Gc("ngModel",a.ticketComment),c.Ob(1),c.Gc("disabled",n.invalid)}}function _(t,e){1&t&&c.ec(0,"app-loader")}function x(t,e){if(1&t){var i=c.jc();c.ic(0,"span",67),c.uc("click",(function(){c.Wc(i);var t=c.yc(2),e=t.$implicit,n=t.index;return c.yc().deleteTicketComment(e.ticketCommentId,n)})),c.ec(1,"i-feather",68),c.hc()}}function N(t,e){if(1&t&&(c.ic(0,"div",55),c.ic(1,"div",12),c.ic(2,"li",56),c.ic(3,"div",57),c.ic(4,"div",58),c.ec(5,"img",59),c.hc(),c.ic(6,"div",60),c.ic(7,"div"),c.ic(8,"h5",61),c.fd(9),c.hc(),c.ic(10,"span",62),c.fd(11),c.hc(),c.ic(12,"div",63),c.dd(13,x,2,0,"span",64),c.hc(),c.hc(),c.ic(14,"p",65),c.fd(15),c.hc(),c.ic(16,"p",66),c.fd(17),c.hc(),c.hc(),c.hc(),c.hc(),c.hc(),c.hc()),2&t){var i=c.yc().$implicit,n=c.yc();c.Ob(9),c.gd(i.userName),c.Ob(2),c.gd(n.getCommentDate(i.insertedOn)),c.Ob(2),c.Gc("ngIf",n.isLoggedUser(i.userId)),c.Ob(2),c.gd(i.roleName),c.Ob(2),c.gd(i.comments)}}function E(t,e){if(1&t&&(c.gc(0),c.dd(1,N,18,5,"div",54),c.fc()),2&t){var i=c.yc();c.Ob(1),c.Gc("ngIf",i.isTicketCommentLoaded)}}function V(t,e){1&t&&(c.ic(0,"div",69),c.ic(1,"li",70),c.ic(2,"div",57),c.ic(3,"div",60),c.ic(4,"h5"),c.fd(5,"No Comments Available"),c.hc(),c.hc(),c.hc(),c.hc(),c.hc())}var W=function(){return{exact:!0}},j=function(){var t=function(){function t(e,i,n,a,o,s,r,d){_classCallCheck(this,t),this.router=e,this.route=i,this.userService=n,this.ticketService=a,this.staffService=o,this.lookupService=s,this.sharedService=r,this.cookieService=d,this.isEditTicket=!1,this.isTicketSubmitted=!1,this.isTicketAdded=!1,this.isError=!1,this.alertMessage="",this.isCommentError=!1,this.isCommentSuccess=!1,this.alertCommentMessage="",this.isTypeSelected=!1,this.documentName="",this.fileList=[],this.listOfFiles=[],this.isFileAdded=!1,this.isTicketCommentLoaded=!1,this.ticketComment="",this.outputParams=new c.q}return _createClass(t,[{key:"isArrayOne",value:function(){return this.ticketArray.length>1}},{key:"deleteTicket",value:function(){this.ticketArray.splice(this.index,1),this.outputParams.emit(this.ticketArray)}},{key:"isAdmin",value:function(){return"Admin"==this.cookieService.get("userRole")||"Staff"==this.cookieService.get("userRole")}},{key:"isCategoryEnabled",value:function(){return!!this.isEditTicket||!!this.isTypeSelected}},{key:"getTicketType",value:function(t){var e=this;this.isTypeSelected=!0,"26"==t?this.lookupService.getLookupValueByLookupTypeId(17).subscribe((function(t){e.ticketCategoryData=t.filter((function(t){return t.isActive}))}),(function(t){})):this.lookupService.getLookupValueByLookupTypeId(16).subscribe((function(t){e.ticketCategoryData=t.filter((function(t){return t.isActive}))}),(function(t){}))}},{key:"uploadFile",value:function(t){this.isFileAdded=!0;for(var e=0;e<=t.target.files.length-1;e++){var i=t.target.files[e];this.fileList.push(i),this.listOfFiles.push({name:i.name,size:i.size})}}},{key:"deleteFile",value:function(t){this.listOfFiles.splice(t,1),this.fileList.splice(t,1),this.selectedFile=null,0==this.fileList.length&&0==this.listOfFiles.length&&(this.isFileAdded=!1)}},{key:"bytesToSize",value:function(t){return t<1024?t+" Bytes":t<1048576?(t/1024).toFixed(3)+" KB":t<1073741824?(t/1048576).toFixed(3)+" MB":(t/1073741824).toFixed(3)+" GB"}},{key:"getCommentDate",value:function(t){return l(t).fromNow()}},{key:"isNoComments",value:function(){return 0==this.ticketCommentsData.length}},{key:"editTicketAgain",value:function(){this.isTicketSubmitted=!1}},{key:"submitTicketForm",value:function(t){var e=this;if(this.isTicketSubmitted=!0,this.isError=!1,this.isEditTicket){var i={ticketId:parseInt(this.route.params.value.id),apartmentId:parseInt(this.cookieService.get("apartmentId")),ticketTypeId:parseInt(this.ticket.ticketTypeId),title:this.ticket.title,description:this.ticket.description,raisedBy:parseInt(this.ticket.raisedBy),ticketStatusId:parseInt(this.ticket.ticketStatusId),ticketCategoryId:parseInt(this.ticket.ticketCategoryId),assignedTo:parseInt(this.ticket.assignedTo),ticketPriorityId:parseInt(this.ticket.ticketPriorityId),isActive:this.ticket.isActive,insertedBy:this.ticket.insertedBy,insertedOn:this.ticket.insertedOn,updatedBy:parseInt(this.cookieService.get("userId")),updatedOn:(new Date).toISOString()};this.ticketService.updateTicket(i).subscribe((function(t){e.isTicketSubmitted=!1,t.message?e.sharedService.setAlertMessage("Ticket Updated successfully"):(e.isError=!0,e.alertMessage=t.alertTicketMessage)}),(function(t){}))}else{var c={apartmentId:parseInt(this.cookieService.get("apartmentId")),ticketTypeId:parseInt(this.ticket.ticketTypeId),title:this.ticket.title,description:this.ticket.description,raisedBy:parseInt(this.ticket.raisedBy),ticketStatusId:parseInt(this.ticket.ticketStatusId),ticketCategoryId:parseInt(this.ticket.ticketCategoryId),assignedTo:parseInt(this.ticket.assignedTo),ticketPriorityId:parseInt(this.ticket.ticketPriorityId),isActive:!0,insertedBy:parseInt(this.cookieService.get("userId")),insertedOn:"2019-11-11T14:50:55.782Z",updatedBy:0,updatedOn:"2019-11-11T14:50:55.782Z"};this.ticketService.addTicket(c).subscribe((function(t){e.isTicketSubmitted=!1,t.message?(e.sharedService.setAlertMessage("Ticket added successfully"),e.isTicketAdded=!0,e.ticketId=t.message):(e.isError=!0,e.alertMessage=t.alertTicketMessage)}),(function(t){}))}}},{key:"deleteTicketComment",value:function(t,e){var i=this;this.isTicketCommentLoaded=!1;var c={ticketCommentId:t,deleteBy:parseInt(this.cookieService.get("userId"))};this.ticketService.deleteTicketComment(c).subscribe((function(t){i.ticketCommentsData.splice(e,1),i.isTicketCommentLoaded=!0}),(function(t){}))}},{key:"submitCommentForm",value:function(t){var e=this,i=new Date,c={ticketId:this.ticketId,comments:this.ticketComment,isActive:!0,insertedBy:parseInt(this.cookieService.get("userId")),insertedOn:i.toISOString(),updatedBy:parseInt(this.cookieService.get("userId")),updatedOn:i.toISOString()};this.ticketService.addTicketComment(c).subscribe((function(t){t.message?(e.isCommentSuccess=!0,e.alertCommentMessage="Comment added successfully",e.isTicketCommentLoaded=!1,e.ticketService.getAllTicketCommentsByTicketId(e.ticketId).subscribe((function(t){e.isTicketCommentLoaded=!0,e.ticketCommentsData=t.filter((function(t){return t.isActive})),d.each(e.ticketCommentsData,(function(t,i){e.userService.getUserById(e.ticketCommentsData[i].insertedBy).subscribe((function(t){e.ticketCommentsData[i].userName=t[0].firstName+" "+t[0].lastName,e.ticketCommentsData[i].userId=t[0].userId}))}))}))):(e.isCommentError=!0,e.alertCommentMessage=t.message)}),(function(t){}))}},{key:"isLoggedUser",value:function(t){return t==parseInt(this.cookieService.get("userId"))}},{key:"ngOnInit",value:function(){var t=this;console.log(this.ticketArray),this.ticket={},this.ticket.ticketCategoryId="",this.ticket.ticketTypeId="",this.ticket.ticketPriorityId="",this.ticket.ticketStatusId="32",this.ticket.raisedBy="",this.ticket.assignedTo="",this.ticketArray=[],this.ticketCommentsData=[],null!=this.route.params.value.id?(this.isEditTicket=!0,this.isTicketAdded=!0,this.ticketId=this.route.params.value.id,this.ticketService.getTicketById(this.route.params.value.id).subscribe((function(e){t.ticket=e[0],t.getTicketType(t.ticket.ticketTypeId),console.log(t.ticket)}),(function(t){})),this.ticketService.getAllTicketCommentsByTicketId(this.route.params.value.id).subscribe((function(e){t.isTicketCommentLoaded=!0,t.ticketCommentsData=e.filter((function(t){return t.isActive})),d.each(t.ticketCommentsData,(function(e,i){t.userService.getUserById(t.ticketCommentsData[i].insertedBy).subscribe((function(e){t.ticketCommentsData[i].userName=e[0].firstName+" "+e[0].lastName,t.ticketCommentsData[i].userId=e[0].userId}),(function(e){t.isTicketCommentLoaded=!0})),t.userService.getRolesByUserId(t.ticketCommentsData[i].insertedBy).subscribe((function(e){t.ticketCommentsData[i].roleName=void 0===e||0==e.length?"-":e[0].roleName}),(function(t){}))}))}))):(this.isTicketCommentLoaded=!0,this.ticketCommentsData=[]),this.lookupService.getLookupValueByLookupTypeId(7).subscribe((function(e){t.ticketTypeData=e.filter((function(t){return t.isActive}))}),(function(t){})),this.lookupService.getLookupValueByLookupTypeId(16).subscribe((function(e){t.ticketCategoryData=e.filter((function(t){return t.isActive}))}),(function(t){})),this.lookupService.getLookupValueByLookupTypeId(14).subscribe((function(e){t.priortyTypeData=e.filter((function(t){return t.isActive}))}),(function(t){})),this.lookupService.getLookupValueByLookupTypeId(9).subscribe((function(e){t.statusTypeData=e.filter((function(t){return t.isActive}))}),(function(t){})),this.userService.getAllUsersByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe((function(e){t.raisedByData=e,"Tenant"!=t.cookieService.get("userRole")&&"Owner"!=t.cookieService.get("userRole")||(t.raisedByData=e.filter((function(e){return e.userId==parseInt(t.cookieService.get("userId"))})),t.ticket.raisedBy=t.raisedByData[0].userId)}),(function(t){})),this.staffService.getAllStaffs().subscribe((function(e){t.assignedToData=e}),(function(t){}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.dc(u.c),c.dc(u.a),c.dc(n.a),c.dc(a.a),c.dc(o.a),c.dc(s.a),c.dc(r.a),c.dc(h.a))},t.\u0275cmp=c.Xb({type:t,selectors:[["app-add-ticket"]],inputs:{index:"index",ticketArray:["array","ticketArray"]},outputs:{outputParams:"outputParams"},decls:24,vars:12,consts:[[1,"helpdesk-add-ticket-wrapper"],[1,"float-left","mt-4"],[4,"ngIf"],[1,"relative-card","float-right"],[1,"relative-icon"],["href","javascript:void(0)","routerLink","/ams/helpdesk/all-tickets","routerLinkActive","active",3,"routerLinkActiveOptions"],[1,"icon-wrapper"],["name","chevron-left",1,"icon","back"],[1,"d-inline-block"],[1,"card","clear","mb-30"],["name","addTicketForm","novalidate","",3,"ngSubmit"],["addTicketForm","ngForm"],[1,"card-body"],[3,"message","isAlert"],["class","card mb-20",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"card"],["class","card-body comments",4,"ngIf"],[1,"row"],["class","col-sm-4",4,"ngIf"],[1,"col-sm-4"],[1,"select-box"],["name","ticketCategory","id","ticketCategory","required","",1,"form-control",3,"ngModel","ngModelChange"],["value","","disabled","","selected","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[1,"input-box"],["type","text","placeholder","Enter text","name","ticketSubject","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-box","select-box"],["name","priortyType","id","priortyType","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","raisedBy","id","raisedBy","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-sm-12"],["placeholder","Enter value","name","ticketDescription","required","",3,"ngModel","ngModelChange"],["for","my-file-selector",1,"btn","sf","lime-green",3,"click"],["id","uploader","name","uploader","type","file","multiple","",1,"form-control",3,"ngModel","ngModelChange","change"],["uploader",""],["aria-hidden","true",1,"fa","fa-paperclip","mr-2"],["class","file-desp",4,"ngIf"],[1,"list-inline","float-right","mt-4"],[1,"list-inline-item"],[1,"btn","blue","mr-2",3,"disabled"],["name","ticketStatus","id","ticketStatus","required","",1,"form-control",3,"ngModel","ngModelChange"],[3,"value"],["name","ticketType","id","ticketType","required","",1,"form-control",3,"ngModel","ngModelChange"],["name","assignedTo","id","assignedTo","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"file-desp"],[1,"name","mr-3"],[1,"size"],["name","x",1,"icon","del",3,"click"],[1,"card","mb-20"],["name","addCommentForm","novalidate","",3,"ngSubmit"],["addCommentForm","ngForm"],[3,"message","isError","isSuccess"],["placeholder","some text here","name","ticketComment","required","",3,"ngModel","ngModelChange"],[1,"btn","blue","float-right",3,"disabled"],["class","card mt-3 comments",4,"ngIf"],[1,"card","mt-3","comments"],[1,"list-group-item"],[1,"media"],[1,"icon","mr-3"],["src","assets/images/user-icon.svg","width","28"],[1,"media-body"],[1,"mt-0"],[1,"ml-3","date"],[1,"float-right","menus"],[3,"click",4,"ngIf"],[1,"role"],[1,"desp"],[3,"click"],["name","x",1,"icon","del"],[1,"card-body","comments"],[1,"list-group-item","no-comments","no-border"]],template:function(t,e){if(1&t){var i=c.jc();c.ic(0,"div",0),c.ic(1,"div",1),c.ic(2,"h5"),c.dd(3,y,2,0,"span",2),c.dd(4,b,2,0,"span",2),c.hc(),c.hc(),c.ic(5,"div",3),c.ic(6,"div",4),c.ic(7,"a",5),c.ic(8,"div",6),c.ec(9,"i-feather",7),c.hc(),c.ic(10,"span",8),c.fd(11,"All Tickets"),c.hc(),c.hc(),c.hc(),c.hc(),c.ic(12,"div",9),c.ic(13,"form",10,11),c.uc("ngSubmit",(function(){c.Wc(i);var t=c.Tc(14);return e.submitTicketForm(t)})),c.ic(15,"div",12),c.ec(16,"app-alert-message",13),c.dd(17,I,1,0,"app-loader",2),c.dd(18,F,52,14,"ng-container",2),c.hc(),c.hc(),c.hc(),c.dd(19,w,13,5,"div",14),c.dd(20,_,1,0,"app-loader",2),c.dd(21,E,2,1,"ng-container",15),c.ic(22,"div",16),c.dd(23,V,6,0,"div",17),c.hc(),c.hc()}2&t&&(c.Ob(3),c.Gc("ngIf",!e.isEditTicket),c.Ob(1),c.Gc("ngIf",e.isEditTicket),c.Ob(3),c.Gc("routerLinkActiveOptions",c.Mc(11,W)),c.Ob(9),c.Gc("message",e.alertMessage)("isAlert",e.isError),c.Ob(1),c.Gc("ngIf",e.isTicketSubmitted),c.Ob(1),c.Gc("ngIf",!e.isTicketSubmitted),c.Ob(1),c.Gc("ngIf",e.isTicketAdded),c.Ob(1),c.Gc("ngIf",!e.isTicketCommentLoaded),c.Ob(1),c.Gc("ngForOf",e.ticketCommentsData),c.Ob(2),c.Gc("ngIf",e.isNoComments()&&e.isEditTicket))},directives:[f.l,u.e,u.d,k.b,m.B,m.o,m.p,g.a,f.k,p.a,m.y,m.x,m.n,m.q,m.r,m.A,v.a,m.d],styles:[".helpdesk-add-ticket-wrapper[_ngcontent-%COMP%]   .card.comments[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:0;border:none;background-color:transparent}.helpdesk-add-ticket-wrapper[_ngcontent-%COMP%]   .card.comments[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{position:relative;z-index:100}.helpdesk-add-ticket-wrapper[_ngcontent-%COMP%]   .card.comments[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{float:left;color:#373946;margin:0 0 6px}.helpdesk-add-ticket-wrapper[_ngcontent-%COMP%]   .card.comments[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:Lato,sans-serif;font-weight:400;letter-spacing:.3px;-webkit-font-smoothing:inherit;-moz-osx-font-smoothing:inherit;font-size:1.4rem;color:#8391a1;cursor:pointer}.helpdesk-add-ticket-wrapper[_ngcontent-%COMP%]   .card.comments[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:14px}.helpdesk-add-ticket-wrapper[_ngcontent-%COMP%]   .card.comments[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .icon.del[_ngcontent-%COMP%]{width:16px}.helpdesk-add-ticket-wrapper[_ngcontent-%COMP%]   .card.comments[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:hover{color:#373946;transition:all .15s ease}.helpdesk-add-ticket-wrapper[_ngcontent-%COMP%]   .card.comments[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   .media[_ngcontent-%COMP%]   p.role[_ngcontent-%COMP%]{background-color:#5cd694;float:left;display:block;padding:0 12px!important;border-radius:18px!important;color:#fff}.helpdesk-add-ticket-wrapper[_ngcontent-%COMP%]   .card.comments[_ngcontent-%COMP%]   li.no-comments[_ngcontent-%COMP%]:before{content:none}"]}),t}()}}]);