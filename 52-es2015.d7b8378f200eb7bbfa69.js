(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{uHHg:function(t,e,i){"use strict";i.r(e);var a=i("ofXK"),c=i("tyNb"),n=i("NutR"),r=i("GUTR"),o=i("ThaB"),s=i("wbvY"),l=i("JK/P"),d=i("F/us"),b=i("wd/R"),u=i("fXoL"),g=i("b6Qw"),m=i("668k"),h=i("BR9Y"),p=i("3Pt+"),f=i("8mtn"),y=i("NhFE"),I=i("bvAq");function k(t,e){1&t&&u.Xb(0,"app-loader")}function v(t,e){if(1&t&&(u.bc(0,"span"),u.Yc(1),u.ac()),2&t){const t=u.rc().$implicit;u.Hb(1),u.Zc(t.amount)}}function D(t,e){1&t&&(u.bc(0,"span"),u.Yc(1,"Free"),u.ac())}const S=function(){return{exact:!0}};function B(t,e){if(1&t){const t=u.cc();u.bc(0,"tr"),u.bc(1,"td",21),u.Yc(2),u.bc(3,"span",22),u.Yc(4),u.ac(),u.ac(),u.bc(5,"td",21),u.Yc(6),u.ac(),u.bc(7,"td",23),u.Yc(8),u.ac(),u.bc(9,"td",23),u.Yc(10),u.ac(),u.bc(11,"td",23),u.Wc(12,v,2,1,"span",1),u.Wc(13,D,2,0,"span",1),u.ac(),u.bc(14,"td"),u.bc(15,"a",24),u.Xb(16,"i-feather",25),u.ac(),u.bc(17,"a",26),u.nc("click",(function(){u.Pc(t);const i=e.index;return u.rc(2).showConfirmModal(i)})),u.Xb(18,"i-feather",27),u.ac(),u.ac(),u.ac()}if(2&t){const t=e.$implicit,i=u.rc(2);u.Hb(2),u.ad(" ",i.getFacilityBookingName(t.apartmentFacilityId)," "),u.Hb(1),u.zc("ngClass",i.getBookingStatus(t.facilityBookingStatusId)),u.Hb(1),u.Zc(i.getBookingStatus(t.facilityBookingStatusId)),u.Hb(2),u.Zc(t.apartmentFacilityBookingId),u.Hb(2),u.Zc(i.getFacilityBookingSlot(t.slotId)),u.Hb(2),u.Zc(i.getBookedDate(t.bookedForDate)),u.Hb(2),u.zc("ngIf",t.amount>0),u.Hb(1),u.zc("ngIf",0==t.amount),u.Hb(2),u.Bc("routerLink","/ams/facility/edit-booking/",t.apartmentFacilityBookingId,""),u.zc("routerLinkActiveOptions",u.Fc(10,S))}}function F(t,e){1&t&&(u.bc(0,"tr"),u.bc(1,"td",28),u.bc(2,"p",29),u.Yc(3,"No Items available"),u.ac(),u.ac(),u.ac())}function H(t,e){if(1&t){const t=u.cc();u.bc(0,"div",3),u.bc(1,"div",4),u.bc(2,"div",5),u.bc(3,"h5"),u.Yc(4,"All Bookings "),u.bc(5,"span",6),u.Yc(6),u.ac(),u.ac(),u.ac(),u.bc(7,"ul",7),u.bc(8,"li",8),u.Xb(9,"i",9),u.bc(10,"input",10),u.nc("ngModelChange",(function(e){return u.Pc(t),u.rc().bookingData=e})),u.ac(),u.ac(),u.bc(11,"li",11),u.bc(12,"a",12),u.Xb(13,"i-feather",13),u.bc(14,"span"),u.Yc(15,"Create Booking"),u.ac(),u.ac(),u.ac(),u.ac(),u.ac(),u.bc(16,"div",14),u.bc(17,"table",15),u.bc(18,"thead"),u.bc(19,"tr"),u.bc(20,"th",16),u.nc("click",(function(){return u.Pc(t),u.rc().sortUnitData("facilityName")})),u.Yc(21,"Facility Name "),u.Xb(22,"span",17),u.ac(),u.bc(23,"th",16),u.nc("click",(function(){return u.Pc(t),u.rc().sortUnitData("facilityId")})),u.Yc(24,"Facility ID "),u.Xb(25,"span",17),u.ac(),u.bc(26,"th",16),u.nc("click",(function(){return u.Pc(t),u.rc().sortUnitData("slot")})),u.Yc(27,"Slot"),u.Xb(28,"span",17),u.ac(),u.bc(29,"th",16),u.nc("click",(function(){return u.Pc(t),u.rc().sortUnitData("date")})),u.Yc(30,"Booked For "),u.Xb(31,"span",17),u.ac(),u.bc(32,"th",16),u.nc("click",(function(){return u.Pc(t),u.rc().sortUnitData("cost")})),u.Yc(33,"Cost "),u.Xb(34,"span",17),u.ac(),u.bc(35,"th",18),u.Yc(36,"Action"),u.ac(),u.ac(),u.ac(),u.bc(37,"tbody"),u.Wc(38,B,19,11,"tr",19),u.sc(39,"slice"),u.sc(40,"sort"),u.sc(41,"simpleSearch"),u.Wc(42,F,4,0,"tr",1),u.ac(),u.ac(),u.bc(43,"app-pagination",20),u.nc("outputParams",(function(e){return u.Pc(t),u.rc().getIndexParams(e)})),u.ac(),u.ac(),u.ac()}if(2&t){const t=u.rc();u.Hb(6),u.Zc(t.totalItems),u.Hb(4),u.zc("ngModel",t.bookingData),u.Hb(2),u.zc("routerLinkActiveOptions",u.Fc(26,S)),u.Hb(5),u.zc("ngClass",t.isMobileView()),u.Hb(5),u.zc("ngClass",t.getFieldOrderBy("facilityName")),u.Hb(3),u.zc("ngClass",t.getFieldOrderBy("facilityId")),u.Hb(3),u.zc("ngClass",t.getFieldOrderBy("slot")),u.Hb(3),u.zc("ngClass",t.getFieldOrderBy("Date")),u.Hb(3),u.zc("ngClass",t.getFieldOrderBy("cost")),u.Hb(4),u.zc("ngForOf",u.vc(39,15,u.vc(40,19,u.uc(41,23,t.bookingListData,t.bookingData),t.unitFieldType,t.unitOrder),t.ItemUserStartIndex,t.ItemUserEndIndex)),u.Hb(4),u.zc("ngIf",t.isNoItems),u.Hb(1),u.zc("totalItems",t.totalItems)("ItemStartIndex",t.ItemStartIndex)("ItemEndIndex",t.ItemEndIndex)("itemLimit",t.itemLimit)}}let L=(()=>{class t{constructor(t,e,i,a,c,n,r,o){this.router=t,this.route=e,this.injector=i,this.userService=a,this.facilityService=c,this.lookupService=n,this.sharedService=r,this.cookieService=o,this.isBookingDataLoaded=!1,this.unitFieldType="unitno",this.unitOrder=!0,this.ItemStartIndex=0,this.itemLimit=10,this.bookingData="",this.staffData="",this.isNoItems=!1,this.modalService=this.injector.get(l.a)}getIndexParams(t){this.ItemStartIndex=t.ItemStartIndex,this.ItemEndIndex=t.ItemEndIndex,this.itemLimit=t.itemLimit}sortUnitData(t){this.unitFieldType=t,this.unitOrder=!this.unitOrder}getFieldOrderBy(t){return this.unitFieldType==t?this.unitOrder?"asc":"desc":""}isMobileView(){return window.innerWidth<=767?"table-responsive":""}getFacilityBookingName(t){var e=d.filter(this.facilityCategoryData,(function(e){if(e.apartmentFacilityId===t)return e}));return void 0===e||0==e.length?"":e[0].facilityName}getFacilityBookingSlot(t){var e=d.filter(this.facilitySlotData,(function(e){if(e.apartmentFacilitySlotId===t)return e}));if(void 0===e||0==e.length)return"";var i=b(e[0].slotBeginTime,"HH:mm:ss").toDate(),a=b(i).format("HH:mm A"),c=b(e[0].slotEndTime,"HH:mm:ss").toDate();return a+" - "+b(c).format("HH:mm A")}getBookedDate(t){return b(t).format("DD/MM/YYYY")}getUserName(t){var e=d.filter(this.userListData,(function(e){if(e.userId===t)return e}));return void 0===e||0==e.length?"":e[0].firstName}getBookingStatus(t){var e=d.filter(this.statusTypeData,(function(e){if(e.lookupValueId===t)return e}));return void 0===e||0==e.length?"":e[0].lookupValueName.toLowerCase()}showConfirmModal(t){this.modalService.showConfirmModal(t)}ngOnInit(){this.facilityService.getApartmentFacilitiesByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilityCategoryData=t.filter(t=>t.isActive),console.log(this.facilityCategoryData)},t=>{}),this.lookupService.getLookupValueByLookupTypeId(40).subscribe(t=>{this.statusTypeData=t.filter(t=>t.isActive)},t=>{}),this.facilityService.getApartmentFacilitySlotsByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilitySlotData=t.filter(t=>t.isActive)},t=>{}),this.userService.getAllUsersByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.userListData=t.filter(t=>t.isActive)},t=>{}),this.facilityService.getApartmentFacilityBookingsByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.bookingListData=t.filter(t=>t.isActive&&t.neededUserId==parseInt(this.cookieService.get("userId"))),0!=this.bookingListData.length&&null!=this.bookingListData||(this.isNoItems=!0),this.totalItems=this.bookingListData.length,this.ItemEndIndex=this.totalItems>this.itemLimit?this.itemLimit:this.totalItems,this.isBookingDataLoaded=!0},t=>{}),this.sharedService.unitlistdeleteindexcast.subscribe(t=>{if(null!=t){var e={apartmentFacilityBookingId:this.bookingListData[t].apartmentFacilityBookingId,deleteBy:parseInt(this.cookieService.get("userId"))};this.isBookingDataLoaded=!1,this.facilityService.deleteApartmentFacilityBooking(e).subscribe(e=>{this.bookingListData.splice(t,1),this.totalItems=this.bookingListData.length,this.isBookingDataLoaded=!0,this.sharedService.setUnitListDeleteIndex(null)},t=>{console.log(t)})}})}}return t.\u0275fac=function(e){return new(e||t)(u.Wb(c.c),u.Wb(c.a),u.Wb(u.s),u.Wb(n.a),u.Wb(r.a),u.Wb(o.a),u.Wb(s.a),u.Wb(g.a))},t.\u0275cmp=u.Qb({type:t,selectors:[["app-all-facility-bookings"]],decls:3,vars:2,consts:[[1,"all-facility-bookings-wrapper"],[4,"ngIf"],["class","card table-card",4,"ngIf"],[1,"card","table-card"],[1,"card-header"],[1,"float-left"],[1,"badge","lime-green"],[1,"list-inline"],[1,"list-inline-item","search","d-none","d-md-inline-block"],["aria-hidden","true",1,"fa","fa-search"],["type","text","placeholder","Search...",1,"form-control",3,"ngModel","ngModelChange"],[1,"list-inline-item"],["routerLink","/user/facility-booking/create-booking","routerLinkActive","active",1,"btn","lime-green","mt_5",3,"routerLinkActiveOptions"],["name","plus",1,"icon","plus"],[1,"card-body","p-0"],[1,"table",3,"ngClass"],["scope","col",3,"click"],[3,"ngClass"],["scope","col"],[4,"ngFor","ngForOf"],[3,"totalItems","ItemStartIndex","ItemEndIndex","itemLimit","outputParams"],[1,"name"],[1,"badge","small","min","text-capitalize",3,"ngClass"],[1,"grey"],["href","javascript:void(0)","placement","top","routerLinkActive","active",1,"mr-2",3,"routerLink","routerLinkActiveOptions"],["name","edit",1,"icon","edit"],["href","javascript:void(0)",3,"click"],["name","trash",1,"icon","delete"],["colspan","6",1,"grey","text-center"],[1,"message"]],template:function(t,e){1&t&&(u.bc(0,"div",0),u.Wc(1,k,1,0,"app-loader",1),u.Wc(2,H,44,27,"div",2),u.ac()),2&t&&(u.Hb(1),u.zc("ngIf",!e.isBookingDataLoaded),u.Hb(1),u.zc("ngIf",e.isBookingDataLoaded))},directives:[a.l,m.a,h.b,p.d,p.l,p.o,c.e,c.d,f.b,a.j,a.k,y.a],pipes:[a.t,I.a,I.e],styles:[""]}),t})();var A=i("iOEq"),C=i("IvIE");function Y(t,e){1&t&&u.Xb(0,"app-loader")}const w=function(){return{left:"today, prev,next",center:"title",right:"dayGridDay,dayGridWeek,dayGridMonth"}};function x(t,e){if(1&t){const t=u.cc();u.Zb(0),u.bc(1,"full-calendar",2),u.nc("eventClick",(function(e){return u.Pc(t),u.rc().handleEventClick(e)})),u.ac(),u.Yb()}if(2&t){const t=u.rc();u.Hb(1),u.zc("plugins",t.calendarPlugins)("header",u.Fc(3,w))("events",t.calendarEvents)}}let W=(()=>{class t{constructor(t,e,i,a,c,n){this.router=t,this.route=e,this.facilityService=i,this.lookupService=a,this.sharedService=c,this.cookieService=n,this.calendarPlugins=[A.a],this.calendarEvents=[],this.isCalenderLoaded=!1}handleEventClick(t){this.router.navigate(["/user/facility-booking/edit-booking",t.event.id])}getFacilityBookingData(){this.facilityService.getApartmentFacilitySlotsByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilitySlotData=t.filter(t=>t.isActive)},t=>{}),this.facilityService.getApartmentFacilitiesByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilityCategoryData=t.filter(t=>t.isActive),this.facilityService.getApartmentFacilityBookingsByApartmentId(parseInt(this.cookieService.get("apartmentId"))).subscribe(t=>{this.facilityBookingData=t.filter(t=>t.isActive&&t.neededUserId==parseInt(this.cookieService.get("userId"))),d.each(this.facilityBookingData,t=>{var e=b(t.bookedForDate).format("YYYY-MM-DD"),i=this.facilityCategoryData.filter(e=>e.apartmentFacilityId==t.apartmentFacilityId),a=this.facilitySlotData.filter(e=>e.apartmentFacilitySlotId==t.slotId),c=b(a[0].slotBeginTime,"HH:mm:ss").toDate(),n=b(c).format("HH:mm A"),r=b(a[0].slotEndTime,"HH:mm:ss").toDate(),o=b(r).format("HH:mm A");this.calendarEvents.push({title:i[0].facilityName+" ( "+n+"-"+o+" ) ",date:e,id:i[0].apartmentFacilityId}),this.isCalenderLoaded=!0})},t=>{})},t=>{})}ngOnInit(){this.getFacilityBookingData()}}return t.\u0275fac=function(e){return new(e||t)(u.Wb(c.c),u.Wb(c.a),u.Wb(r.a),u.Wb(o.a),u.Wb(s.a),u.Wb(g.a))},t.\u0275cmp=u.Qb({type:t,selectors:[["app-user-facility-calendar"]],decls:3,vars:2,consts:[[1,"full-calendar-wrapper"],[4,"ngIf"],["defaultView","dayGridMonth",3,"plugins","header","events","eventClick"]],template:function(t,e){1&t&&(u.bc(0,"div",0),u.Wc(1,Y,1,0,"app-loader",1),u.Wc(2,x,2,4,"ng-container",1),u.ac()),2&t&&(u.Hb(1),u.zc("ngIf",!e.isCalenderLoaded),u.Hb(1),u.zc("ngIf",e.isCalenderLoaded))},directives:[a.l,m.a,C.a],styles:[""]}),t})();var z=i("Nw7d");const O=[{path:"",redirectTo:"all-bookings",pathMatch:"full"},{path:"all-bookings",component:L},{path:"create-booking",component:z.a},{path:"edit-booking/:id",component:z.a},{path:"calendar",component:W},{path:"**",redirectTo:"all-bookings",pathMatch:"full"}];let N=(()=>{class t{}return t.\u0275mod=u.Ub({type:t}),t.\u0275inj=u.Tb({factory:function(e){return new(e||t)},imports:[[c.f.forChild(O)],c.f]}),t})();var M=i("PCNd");let P=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Qb({type:t,selectors:[["app-facility-booking"]],decls:1,vars:0,template:function(t,e){1&t&&u.Xb(0,"router-outlet")},directives:[c.g],styles:[""]}),t})();i.d(e,"FacilityBookingModule",(function(){return E}));let E=(()=>{class t{}return t.\u0275mod=u.Ub({type:t,bootstrap:[P]}),t.\u0275inj=u.Tb({factory:function(e){return new(e||t)},imports:[[a.b,M.a,N]]}),t})()}}]);